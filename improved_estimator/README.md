# Improved Estimatorのわかりやすい(つもりの)説明

## はじめに

Improved Estimatorが分かりづらい。教科書にもさらっとした触れられてないし、引用文献も見当たらない。ググってもよくわからないが、知っている人は知っている。そんなImproved Estimatorについて僕でもわかるようにわかりやすく説明したつもりの記事です。いか、かなりレベルの低いところから書いているので、モンテカルロガチ勢な人はブラウザの戻るボタンを押すかタブを閉じてください。

## マルコフ連鎖モンテカルロ法

Improved Estimatorについて調べてたら、「そもそもなんでマルコフ連鎖モンテカルロ法で物理量が推定できるんだっけ？」というところからあやふやになってきたので、そこからまとめます。この記事はそんなレベルの人が書いています。

なにか系の状態が$S$で表現されているとします。スピン系の言葉で言うなら、$S$はスピンコンフィグレーションを表します。$N$個の$\pm 1$イジングスピン系なら、$S$は$N$個の-1か1の数の配列だと思えば良いです。スピンを$\sigma_i$で表します。以下、$S$があるスピン状態を表すことを

$$
S = \left\{ \sigma_i \right\}
$$

と表現しましょう。

さて、この系の状態$S$について、重み$w(S)$が指定されているとします。ただし、$w$は規格化されており、すべてのとり得る$S$について和を取ると$1$となるものとします。

$$
\sum_{\{S\}} w(S) = 1
$$

イジングモデルの言葉で言えば、ハミルトニアン

$$
H = -J \sum_{\left< i,j \right>} \sigma_i \sigma_j
$$

に対して、ボルツマン重みを規格化したものが$w$です。具体的に書くと、

$$
w(S) = \frac{\exp(-\beta H(S))}{\sum_{\{S'\}}\exp(-\beta H(S'))}
$$

です。分母はいわゆる分配関数ですね。

いま、物理量$A$が状態$S$の関数として求まるとしましょう。この時、$A$の期待値$\left< A\right>$は

$$
\left< A\right> = \sum_{\left\{S\right\}} A(S)w(S)
$$

で求めることができます。しかし、一般に$S$がとり得る状態数は膨大($N$個のイジングスピン系なら$2^N$個の状態がある)で、この和を実行することはできません。そこで、サンプリングによりこの和を評価することにします。

マルコフ連鎖モンテカルロ法は、時刻$t$における状態$S_t$から、なにかうまいことをやって次の状態$S_{t+1}$を作ります。
