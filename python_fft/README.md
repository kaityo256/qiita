# Pythonでフーリエ変換

## はじめに

何かデータをフーリエ変換したくなることがある。例えば先生から「そのデータ、フーリエ変換してみたら？」と言われた時とか。なんとなくフーリエ変換がどういうものかは知っていて、PythonとかのライブラリにFFTがあるからデータを食わせればすぐ変換できるということも知っているが、なんとなくぼんやりしていて定義に自信が無い、そんな時もあるだろう。

そういう場合は、厳密にフーリエ変換がわかるような単純な系について実際にデータを食わせてみて、理論値と一致することを確認するのが望ましい。それを見てみよう。

## ガウス分布

### ガウス分布のフーリエ変換

まずはフーリエ変換の定義から確認しておこう。ある関数$f(x)$のフーリエ変換$\hat{f}(k)$は

$$
\hat{f}(k) = \int_{-\infty}^\infty f(x) e^{-ikx} dx
$$

で与えられる。逆変換と対称にするために$\sqrt{2\pi}$で割る流儀もあるが、工学で使うフーリエ変換では、フーリエ変換はそのまま、逆フーリエ変換に$2\pi$をつける流儀が多いと思われる。

簡単にフーリエ変換できて、かつそれなりに非自明な例としてガウス分布が挙げられる。こんな分布を考えよう。

$$
f(x) = \frac{1}{\sqrt{2 \pi \sigma^2}} \exp\left(- \frac{x^2}{2\sigma^2} \right)
$$

これは平均0、標準偏差$\sigma$であるようなガウス分布である。これをフーリエ変換しよう。定義につっこんで計算するだけだ。

$$
\begin{aligned}
\hat{f}(k) &= \int_{-\infty}^\infty f(x) e^{-ikx} \\
&=  \frac{1}{\sqrt{2 \pi \sigma^2}}  \int_{-\infty}^\infty\exp\left(- \frac{x^2}{2\sigma^2} \right) e^{-ikx} dx
\end{aligned}
$$

この計算にはちょっとした工夫が必要だ。まず指数関数の中身を平方完成する。

$$
- \frac{x^2}{2\sigma^2} - ikx = -\frac{1}{2\sigma^2}
(x + i\sigma k)^2 - \frac{\sigma^2 k^2}{2}
$$

上式の右辺第一項を指数の肩に乗せたものはガウス積分であり、$1/\sqrt{2\pi \sigma^2}$とキャンセルする。したがって最終的に

$$
\hat{f}(k) = \exp\left(- \frac{\sigma^2 k^2}{2}\right)
$$

つまり、ガウス分布をフーリエ変換したものは、規格化されておらず、かつ標準偏差が逆数になったようなガウス分布になる。つまり、実空間で「幅の広い」ガウス分布は、波数空間では「幅の狭い」ガウス分布になる(逆もまた然り)。

上記をPythonで確認してみよう。

### ガウス分布のFFT

Pythonでデータをフーリエ変換するのは簡単で、配列を`numpy.fft.ftt`に渡すだけで良い。まずはガウス分布を作ってみよう。

```py
import numpy as np
from math import sqrt, pi, exp
import matplotlib.pyplot as plt

N = 4096            # サンプル数
s = N/256           # 標準偏差

y = []
for i in range(N):
  x = i - N/2
  v = exp(-x**2/(2.0*s**2))/(sqrt(2*pi)*s)
  y.append(v)

fig, ax = plt.subplots()
ax.plot(y)
ax.grid()
plt.xlim([N/2-100,N/2+100])
plt.show()
```

これは、データ点をN=4096とし、N/2を中心に、N/256=16を標準偏差とするガウス分布で、プロットするとこんな感じになる。

![ガウス分布](gauss1.png)

さて、配列`y`にデータが入っているので、フーリエ変換をするにはそれを`np.fft.fft`に突っ込めば良い。突っ込んだものを`fk`としてプロットしてみよう。

```py
fk = np.fft.fft(y)
plt.plot(fk)
```

するとこうなる。

![ガウス分布のフーリエ変換](gauss2.png)

なんか変なデータになっていますね。これがどうなっているかを理解しちゃんと理論値と比較できるようになるのが本稿の目的だ。